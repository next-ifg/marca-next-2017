% 
% NExT Beamer Theme
% 
% Autor: Pedro Maione [pedromaionee@gmail.com]
%


\ProvidesPackage{beamerthemenext}[2017/04/12]

\newif\if@PaginaSecao
\@PaginaSecaofalse
\DeclareOption{nosectionpages}{\@PaginaSecaotrue}
\ProcessOptions

\RequirePackage{eso-pic}
\RequirePackage[brazilian]{babel}
\RequirePackage[utf8x]{inputenc}
\RequirePackage{epstopdf}
\RequirePackage{graphicx}
\RequirePackage{multicol}
\usepackage{fontspec}

% Configuração de fontes
\setmainfont[%
BoldFont={Open Sans Bold},%
BoldItalicFont={Open Sans Bold Italic},%
]{Open Sans}
\setsansfont[Ligatures=TeX]{Roboto}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% Font
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\defaultfontfeatures{Ligatures=TeX}
\frenchspacing
% For source code
\setmonofont[%
BoldFont=DejaVu Sans Mono Bold,
]{DejaVu Sans Mono Bold}

% Normal font
\setsansfont{Open Sans}[
% Numbers=OldStyle,
BoldFont=Open Sans Bold,
ItalicFont=Open Sans Italic,
BoldItalicFont=Open Sans Bold Italic,
]
% Font for section, subsection, subsubsection, etc
\newfontfamily{\titlefont}{Roboto Condensed}[
Numbers=OldStyle,
BoldFont=Roboto Condensed Regular,
ItalicFont=Roboto Condensed Italic,
BoldItalicFont=Roboto Condensed Bold Italic,
]
% Font for chapter number
\newfontfamily{\upperNumber}{Roboto}[
BoldFont=Roboto Regular,
ItalicFont=Roboto Italic,
BoldItalicFont=Roboto Bold Italic,
]


\usepackage{tikz}
\usetikzlibrary{arrows,decorations.pathmorphing,backgrounds,positioning,fit,mindmap}

\mode<presentation>

% ---------------------------------------------------------------------
% Sumario (Table of Contents)
% ---------------------------------------------------------------------
\useoutertheme[subsection=false,shadow]{miniframes}
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

% ---------------------------------------------------------------------
% custom commands
% ---------------------------------------------------------------------
\newcommand{\NExT}{Núcleo de Estudos e Pesquisas Experimentais e Tecnológicas}
\newcommand{\IFG}{Instituto Federal de Educação, Ciência e Tecnologia de Goiás}
\newcommand{\setaDireita}{$\Rightarrow{}$}

% ---------------------------------------------------------------------
% Itemize
% ---------------------------------------------------------------------
\setbeamertemplate{itemize item}{\setaDireita}
\setbeamertemplate{itemize subitem}{\setaDireita}
\setbeamertemplate{itemize subsubitem}{\setaDireita}

\setlength{\parskip}{0.5em}

% ---------------------------------------------------------------------
% Paleta de Cores
% ---------------------------------------------------------------------

\definecolor[named]{nextVermelho}{HTML}{FF1D06}
\definecolor[named]{nextLaranja}{HTML}{FF9206}
\definecolor[named]{nextAzul}{HTML}{0E65A3}
\definecolor[named]{nextVerde}{HTML}{04C02E}

\definecolor[named]{nextCinza}{HTML}{262626}
\definecolor[named]{nextCinzaClaro}{HTML}{676767}

\definecolor[named]{nextVermelhoEscuro}{HTML}{C91B08}
\definecolor[named]{nextLaranjaEscuro}{HTML}{C97508}
\definecolor[named]{nextAzulEscuro}{HTML}{064257}
\definecolor[named]{nextVerdeEscuro}{HTML}{069826}

\definecolor[named]{nextVermelhoClaro}{HTML}{FF3B26}
\definecolor[named]{nextLaranjaClaro}{HTML}{FFA126}
\definecolor[named]{nextAzulClaro}{HTML}{2478B4}
\definecolor[named]{nextVerdeClaro}{HTML}{1ECC45}


% Geral
\setbeamercolor{normal text}{fg=black}
\setbeamercolor{structure}{fg=nextCinzaClaro}
\setbeamercolor{alerted text}{fg=nextVermelho}
\setbeamercolor{example text}{fg=white}
\setbeamercolor{copyright text}{fg=nextCinzaClaro}
\setbeamercolor{palette primary}{fg=nextCinza}
\setbeamercolor{palette secondary}{fg=white,bg=nextCinzaClaro}
\setbeamercolor{palette tertiary}{fg=white,bg=nextCinza}
\setbeamercolor{palette quaternary}{fg=white, bg=nextCinza}
% Titlepage
\setbeamercolor{title}{parent=normal text, fg=nextVermelhoqEscuro}
\setbeamercolor{subtitle}{parent=normal text}
\setbeamercolor{institute}{parent=normal text}
% Content
\setbeamercolor{frametitle}{parent=palette quaternary}
% Blocks
\setbeamercolor{block title}{parent=palette quaternary}
\setbeamercolor{block body}{parent=palette secondary}
\setbeamercolor{block title example}{fg=white, bg=nextVerdeEscuro}
\setbeamercolor{block body example}{fg=nextCinza, bg=nextVerdeClaro}
\setbeamercolor{block title alerted}{fg=white, bg=nextVermelhoEscuro}
\setbeamercolor{block body alerted}{fg=white, bg=nextVermelhoClaro}
% Notes
\setbeamercolor{note page}{fg=nextCinza,bg=nextCinzaClaro}
\setbeamercolor{note title}{fg=white, bg=nextCinza}
\setbeamercolor{note date}{parent=note title}
% Page Number
\setbeamercolor{page number in head/foot}{fg=nextCinza}


% Fontes

% Titlepage
\setbeamerfont{title}{size=\fontsize{20}{20}}
\setbeamerfont{subtitle}{size=\fontsize{12}{14}}
\setbeamerfont{date}{size=\fontsize{8}{10}}
\setbeamerfont{author}{size=\fontsize{12}{15}}
\setbeamerfont{institute}{size=\fontsize{8}{10}}
% Section
\setbeamerfont{section title}{size=\LARGE}
% Content
\setbeamerfont{frametitle}{size=\large}
\setbeamerfont{copyright text}{size=\tiny}
\setbeamerfont{block title}{size=\large}
\setbeamerfont{block title example}{size=\large}
\setbeamerfont{block title alerted}{size=\large}
% Captions
\setbeamerfont{caption name}{family=\ttfamily}

% ---------------------------------------------------------------------
% Titlepage
% ---------------------------------------------------------------------

% Estrutura da capa (titlepage)
\def\maketitle{%
  \ifbeamer@inframe%
  \titlepage%
  \else%
  \frame[plain]{%
    \titlepage%
  }%
  \fi%
}%

\def\titlepage{\usebeamertemplate{title page}}

\setbeamertemplate{title page}
{
  % Adiciona o background
  \tikz[remember picture, overlay]{%
      \node[opacity=1,inner sep=0pt] at (current page.center){%
        \includegraphics[width=\paperwidth,height=\paperheight]{./capa43.eps}%
      };%
      \node (titulo) [below left=25mm and 10mm of current page.center, anchor=west] {%
        \parbox[t]{6cm}{
          \ifx\insertsubtitle\@empty%
          \else%
          % Insere titulo
          {\usebeamerfont{title}\usebeamercolor[fg]{title}
            \MakeUppercase{\inserttitle}\par
            {\color{nextCinza}\rule[5mm]{\linewidth}{1mm}}
          }%
          \fi%
          % Insere subtitulo
          \ifx\insertsubtitle\@empty%
          \else%
          {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
          \fi%
        }
      };

      \node (autor) [above right=3mm and 35mm of current page.south west]{%
        \parbox{12cm}{%
          % Insere Autor
          \ifx\insertauthor\@empty%
          \else%
          {\usebeamerfont{author}\usebeamercolor[fg]{author}\insertauthor\par}%
          \fi%
        }
      };
      \node (data) [above right=3mm and 95mm of current page.south west]{%
        \parbox{12cm}{%
          % Insere Data
          \ifx\insertdate\@empty%
          \else%
          {\usebeamerfont{date}\usebeamercolor[fg]{date}\insertdate\par}%
          \fi%
        }
      };
      
      \node (institute) [below right=7mm and 1mm of current page.north west,
      anchor=west]{%
        \parbox{12cm}{%
          % Insere Instituto
          \ifx\insertinstitut\@empty%
          \else%
          \vspace*{5mm}
          {\usebeamerfont{institute}\usebeamercolor[fg]{institute}\insertinstitute\par}%
          \fi% 
        }
      }
    }%
}

% ---------------------------------------------------------------------
% Sectionpages
% ---------------------------------------------------------------------

% Converte o titulo de seção em caixa alta
\newcommand{\insertsectionHEAD}{%
  \expandafter\insertsectionHEADaux\insertsectionhead}
\newcommand{\insertsectionHEADaux}[3]{\MakeUppercase{#3}
}

\if@PaginaSecao\@empty
\else
% Insert um slide com o titulo da seção
\AtBeginSection[]{%
  \begingroup
  % \setbeamercolor{background canvas}{bg=nextCinza}
  \begin{frame}[plain]
    % \AddToShipoutPictureFG*{%
    % \includegraphics[width=\paperwidth]{background43.pdf}%
    % }
    \centering
    \vfill%
    \usebeamerfont{section title}%
    \textcolor{nextVermelhoEscuro}{%
      \insertsectionHEAD%
    }%
    \vfill%
  \end{frame}
  \endgroup
}
\fi

% ---------------------------------------------------------------------
% Frametitle
% ---------------------------------------------------------------------
\setbeamertemplate{frametitle}{%
  \begin{beamercolorbox}[%
    wd=\paperwidth,%
    leftskip=0.3cm,%
    rightskip=0.3cm,%
    ht=3ex,%
    dp=1.5ex%
    ]{frametitle}
    \usebeamerfont{frametitle}\MakeUppercase{\insertframetitle}%
  \end{beamercolorbox}
}

% ---------------------------------------------------------------------
% Footline
% ---------------------------------------------------------------------
\usenavigationsymbolstemplate{}
\setbeamertemplate{footline}{%
  \begin{beamercolorbox}[%
    wd=\textwidth,%
    ht=3ex,%
    dp=1.5ex,%
    leftskip=0.3cm,%
    rightskip=0.3cm%
    ]{structure}%
    \hfill\usebeamerfont{page number in head/foot}%
    \insertframenumber%
  \end{beamercolorbox}%
}

% ---------------------------------------------------------------------
% Captions
% ---------------------------------------------------------------------
\setbeamertemplate{caption label separator}{: }

% ---------------------------------------------------------------------
% Blocks
% ---------------------------------------------------------------------
\setbeamertemplate{block begin}
{
  \setbeamercolor{item}{parent=block body}
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex]{block title}
    \usebeamerfont*{block title}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body}%
  \begin{beamercolorbox}[%
    sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex,%
    vmode%
    ]{block body}%
  }
  \setbeamertemplate{block end}  
  {\end{beamercolorbox}\vskip\smallskipamount}

\setbeamertemplate{block alerted begin}
{
  \setbeamercolor{item}{parent=block body alerted}
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[%
    sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex%
    ]{block title alerted}
    \usebeamerfont*{block title alerted}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body alerted}%
  \begin{beamercolorbox}[%
    sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex,%
    vmode%
    ]{block body alerted}%
  }
  \setbeamertemplate{block alerted end}
  {\end{beamercolorbox}\vskip\smallskipamount}

\setbeamertemplate{block example begin}
{
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[%
    sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex%
    ]{block title example}
    \usebeamerfont*{block title example}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body example}%
  \begin{beamercolorbox}[%
    sep=.5ex,%
    dp=0.6ex,%
    leftskip=0.5ex,%
    rightskip=0.5ex,%
    vmode%
    ]{block body example}%
  }
  \setbeamertemplate{block example end}
  {\end{beamercolorbox}\vskip\smallskipamount}

\mode<all>

% Local Variables:
% TeX-engine: xetex
% End:
